<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>í…ŒìŠ¤íŠ¸ - ë…¼ë¦¬ìˆ˜í•™ í€´ì¦ˆ</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test { margin: 10px 0; padding: 10px; border: 1px solid #ccc; border-radius: 5px; }
        .pass { background-color: #d4edda; border-color: #c3e6cb; }
        .fail { background-color: #f8d7da; border-color: #f5c6cb; }
        .loading { background-color: #fff3cd; border-color: #ffeaa7; }
        h1 { color: #333; }
        .spinner { display: inline-block; width: 20px; height: 20px; border: 3px solid #f3f3f3; border-top: 3px solid #3498db; border-radius: 50%; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body>
    <h1>ğŸ§ª ì‹œìŠ¤í…œ í…ŒìŠ¤íŠ¸</h1>
    
    <div id="test-results">
        <div class="test loading">
            <strong>í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ì¤‘...</strong><br>
            <span class="spinner"></span> ì ì‹œë§Œ ê¸°ë‹¤ë ¤ì£¼ì„¸ìš”...
        </div>
    </div>
    
    <script src="js/database.js"></script>
    <script src="data/questions.js"></script>
    <script src="data/additional-questions.js"></script>
    
    <script>
        async function runTests() {
            const results = [];
            
            // í…ŒìŠ¤íŠ¸ 0: ê¸°ë³¸ í™˜ê²½ ì²´í¬
            try {
                if (typeof console === 'undefined' || typeof window === 'undefined') {
                    throw new Error('ë¸Œë¼ìš°ì € í™˜ê²½ì´ ì•„ë‹™ë‹ˆë‹¤');
                }
                results.push({ name: "ê¸°ë³¸ í™˜ê²½", status: "pass", message: "âœ… ë¸Œë¼ìš°ì € í™˜ê²½ ì •ìƒ" });
            } catch (error) {
                results.push({ name: "ê¸°ë³¸ í™˜ê²½", status: "fail", message: "âŒ " + error.message });
            }
            
            // í…ŒìŠ¤íŠ¸ 1: í•„ìˆ˜ ìŠ¤í¬ë¦½íŠ¸ ë¡œë”© í™•ì¸
            try {
                const checks = {
                    database: typeof MathQuizDatabase !== 'undefined',
                    questions: typeof questionsData !== 'undefined',
                    additionalQuestions: typeof mergeAdditionalQuestions !== 'undefined'
                };
                
                const allLoaded = Object.values(checks).every(Boolean);
                if (allLoaded) {
                    results.push({ name: "ìŠ¤í¬ë¦½íŠ¸ ë¡œë”©", status: "pass", message: "âœ… ëª¨ë“  ìŠ¤í¬ë¦½íŠ¸ ì •ìƒ ë¡œë“œë¨" });
                } else {
                    results.push({ 
                        name: "ìŠ¤í¬ë¦½íŠ¸ ë¡œë”©", 
                        status: "fail", 
                        message: `âŒ ì¼ë¶€ ìŠ¤í¬ë¦½íŠ¸ ë¡œë“œ ì‹¤íŒ¨: ${JSON.stringify(checks)}` 
                    });
                }
            } catch (error) {
                results.push({ name: "ìŠ¤í¬ë¦½íŠ¸ ë¡œë”©", status: "fail", message: "âŒ " + error.message });
            }
            
            // í…ŒìŠ¤íŠ¸ 2: ë°ì´í„°ë² ì´ìŠ¤ ì´ˆê¸°í™”
            try {
                const db = new MathQuizDatabase();
                await new Promise(resolve => setTimeout(resolve, 1000));
                results.push({ name: "ë°ì´í„°ë² ì´ìŠ¤ ì´ˆê¸°í™”", status: "pass", message: "âœ… IndexedDB ì •ìƒ ì‘ë™" });
            } catch (error) {
                results.push({ name: "ë°ì´í„°ë² ì´ìŠ¤ ì´ˆê¸°í™”", status: "fail", message: "âŒ " + error.message });
            }
            
            // í…ŒìŠ¤íŠ¸ 3: ë¬¸ì œ ë°ì´í„° í™•ì¸
            try {
                const easyCount = questionsData.easy.length;
                const mediumCount = questionsData.medium.length;
                const hardCount = questionsData.hard.length;
                
                if (easyCount >= 5 && mediumCount >= 5 && hardCount >= 5) {
                    results.push({ 
                        name: "ë¬¸ì œ ë°ì´í„°", 
                        status: "pass", 
                        message: `âœ… ì‰¬ì›€: ${easyCount}ê°œ, ë³´í†µ: ${mediumCount}ê°œ, ì–´ë ¤ì›€: ${hardCount}ê°œ` 
                    });
                } else {
                    results.push({ 
                        name: "ë¬¸ì œ ë°ì´í„°", 
                        status: "fail", 
                        message: "âŒ ë¬¸ì œ ë°ì´í„° ë¶€ì¡±" 
                    });
                }
            } catch (error) {
                results.push({ name: "ë¬¸ì œ ë°ì´í„°", status: "fail", message: "âŒ " + error.message });
            }
            
            // í…ŒìŠ¤íŠ¸ 4: React ë¼ì´ë¸ŒëŸ¬ë¦¬ í™•ì¸
            try {
                if (typeof React !== 'undefined' && typeof ReactDOM !== 'undefined') {
                    results.push({ name: "React ë¼ì´ë¸ŒëŸ¬ë¦¬", status: "pass", message: "âœ… React ì •ìƒ ë¡œë“œë¨" });
                } else {
                    results.push({ name: "React ë¼ì´ë¸ŒëŸ¬ë¦¬", status: "fail", message: "âŒ React ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¡œë“œ ì‹¤íŒ¨" });
                }
            } catch (error) {
                results.push({ name: "React ë¼ì´ë¸ŒëŸ¬ë¦¬", status: "fail", message: "âŒ " + error.message });
            }
            
            // í…ŒìŠ¤íŠ¸ 5: ë¸Œë¼ìš°ì € í˜¸í™˜ì„± í™•ì¸
            try {
                const features = {
                    indexedDB: 'indexedDB' in window,
                    localStorage: 'localStorage' in window,
                    es6: typeof Promise !== 'undefined'
                };
                
                const allSupported = Object.values(features).every(Boolean);
                if (allSupported) {
                    results.push({ name: "ë¸Œë¼ìš°ì € í˜¸í™˜ì„±", status: "pass", message: "âœ… ëª¨ë“  í•„ìˆ˜ ê¸°ëŠ¥ ì§€ì›" });
                } else {
                    results.push({ 
                        name: "ë¸Œë¼ìš°ì € í˜¸í™˜ì„±", 
                        status: "fail", 
                        message: `âŒ ì¼ë¶€ ê¸°ëŠ¥ ë¯¸ì§€ì›: ${JSON.stringify(features)}` 
                    });
                }
            } catch (error) {
                results.push({ name: "ë¸Œë¼ìš°ì € í˜¸í™˜ì„±", status: "fail", message: "âŒ " + error.message });
            }
            
            // ê²°ê³¼ ì¶œë ¥
            displayResults(results);
        }
        
        function displayResults(results) {
            const container = document.getElementById('test-results');
            container.innerHTML = '';
            
            results.forEach(result => {
                const div = document.createElement('div');
                div.className = `test ${result.status}`;
                div.innerHTML = `
                    <strong>${result.name}</strong><br>
                    ${result.message}
                `;
                container.appendChild(div);
            });
            
            const passCount = results.filter(r => r.status === 'pass').length;
            const totalCount = results.length;
            
            const summary = document.createElement('div');
            summary.style.marginTop = '20px';
            summary.style.padding = '15px';
            summary.style.backgroundColor = passCount === totalCount ? '#d4edda' : '#fff3cd';
            summary.style.border = `2px solid ${passCount === totalCount ? '#28a745' : '#ffc107'}`;
            summary.innerHTML = `
                <h3>í…ŒìŠ¤íŠ¸ ê²°ê³¼ ìš”ì•½</h3>
                <p><strong>${passCount}/${totalCount}</strong> í…ŒìŠ¤íŠ¸ í†µê³¼</p>
                ${passCount === totalCount 
                    ? '<p>ğŸ‰ <strong>ëª¨ë“  í…ŒìŠ¤íŠ¸ í†µê³¼!</strong> ê²Œì„ì´ ì •ìƒ ì‘ë™í•  ì¤€ë¹„ê°€ ë˜ì—ˆìŠµë‹ˆë‹¤.</p>' 
                    : '<p>âš ï¸ ì¼ë¶€ í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨. ë¬¸ì œë¥¼ í•´ê²°í•œ í›„ ë‹¤ì‹œ í…ŒìŠ¤íŠ¸í•´ì£¼ì„¸ìš”.</p>'
                }
                <p><a href="index.html">ğŸ® ê²Œì„ ì‹œì‘í•˜ê¸°</a></p>
            `;
            container.appendChild(summary);
        }
        
        // í˜ì´ì§€ ë¡œë“œ í›„ í…ŒìŠ¤íŠ¸ ì‹¤í–‰
        window.addEventListener('load', () => {
            setTimeout(runTests, 1000); // 1ì´ˆ í›„ í…ŒìŠ¤íŠ¸ ì‹¤í–‰ (ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¡œë”© ëŒ€ê¸°)
        });
    </script>
</body>
</html>